<!doctype html><html lang="cs"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Pricing Test</title><style>body{font-family:-apple-system,'SF Pro Text','Segoe UI',Roboto,Helvetica,Arial;margin:0;background:linear-gradient(160deg,#eef5ff,#f7fbff)}.wrap{max-width:1100px;margin:28px auto;padding:16px}.card{backdrop-filter:blur(16px);background:rgba(255,255,255,.6);border:1px solid rgba(255,255,255,.7);border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,.12);padding:16px;margin-bottom:12px}label{display:block;margin:10px 0 4px;font-weight:600}input,select,textarea{padding:10px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:rgba(255,255,255,.85);outline:none}input[type=text],input[type=number],textarea{width:100%}.row{display:flex;gap:12px;flex-wrap:wrap}.row>*{flex:1 1 180px}button{padding:10px 14px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:#fff;cursor:pointer;font-weight:600}button.primary{background:#4dabff;color:#fff;border:none}table{width:100%;border-collapse:separate;border-spacing:0 8px}th,td{padding:10px;background:#fff;border:1px solid rgba(0,0,0,.06);vertical-align:top}th{background:#f6f9ff;text-align:left}.muted{color:rgba(0,0,0,.6)}</style></head><body><div class="wrap"><h2>Pricing Test</h2><div class="card"><div class="row"><div><label>Název</label><input id="pname" type="text" placeholder="Fotokniha Pro A4"></div><div><label>Měna</label><select id="ccy"><option>CZK</option><option>EUR</option></select></div><div><label>DPH (%)</label><input id="vat" type="number" step="0.1" value="21"></div></div><div class="row"><div><label>Základní cena</label><input id="base" type="number" step="0.01" value="499"></div><div><label>Množství</label><input id="qty" type="number" step="1" value="1"></div><div><label>Extra stránky (ks)</label><input id="extraPages" type="number" step="2" value="0"></div><div><label>Cena za 2 stránky</label><input id="pricePer2Pages" type="number" step="0.01" value="29"></div></div><div class="row"><div><label>Příplatky (JSON array)</label><textarea id="addons" placeholder='[{"label":"Tvrdá vazba","type":"fix","value":149},{"label":"Luxusní papír","type":"fix","value":199},{"label":"Sleva 10%","type":"percent","value":-10}]'></textarea></div><div><label>Vybrané příplatky (indexy)</label><input id="selected" type="text" placeholder="např. 0,2"></div></div><div class="row"><div><button id="calc" class="primary">Spočítat</button></div></div></div><div class="card"><h3>Výsledek</h3><table><tbody id="out"></tbody></table><div class="muted">Procenta se aplikují na mezisoučet po fix příplatcích a stránkách.</div></div></div><script>function money(v){return(Math.round(v*100)/100).toFixed(2)}function tr(a,b){return `<tr><th>${a}</th><td>${b}</td></tr>`}const $=s=>document.querySelector(s);const pname=$('#pname'),ccy=$('#ccy'),vat=$('#vat'),base=$('#base'),qty=$('#qty'),extraPages=$('#extraPages'),pricePer2Pages=$('#pricePer2Pages'),addons=$('#addons'),selected=$('#selected'),out=$('#out');document.querySelector('#calc').addEventListener('click',()=>{const currency=ccy.value;const vatPct=parseFloat(vat.value||'0');const basePrice=parseFloat(base.value||'0');const Q=Math.max(1,parseInt(qty.value||'1',10));const pages=Math.max(0,parseInt(extraPages.value||'0',10));const per2=parseFloat(pricePer2Pages.value||'0');let adds=[];try{adds=JSON.parse(addons.value||'[]')}catch(e){adds=[]}const sel=(selected.value||'').split(',').map(s=>parseInt(s.trim(),10)).filter(n=>!isNaN(n));let subtotal=basePrice;const pagePairs=Math.ceil(pages/2);const pagesCost=pagePairs*per2;subtotal+=pagesCost;let fixAdds=0,percentAdds=0,labels=[];sel.forEach(i=>{const a=adds[i];if(!a)return;if(a.type==='percent'){percentAdds+=a.value;labels.push(`${a.label} (${a.value>0?'+':''}${a.value}%)`)}else{fixAdds+=parseFloat(a.value||'0');labels.push(`${a.label} +${money(a.value)} ${currency}`)}});subtotal+=fixAdds;const percentDelta=subtotal*(percentAdds/100);subtotal+=percentDelta;const lineTotal=subtotal*Q;const vatAmt=lineTotal*(vatPct/100);const total=lineTotal+vatAmt;out.innerHTML=[tr('Základ',money(basePrice)+' '+currency),tr('Stránky navíc',`${pages} (účtováno ${pagePairs}× ${money(per2)} ${currency}) = ${money(pagesCost)} ${currency}`),tr('Příplatky',labels.length?labels.join(', '):'–'),tr('Mezisoučet (1 ks)',money(subtotal)+' '+currency),tr('Množství',Q),tr('Součet bez DPH',money(lineTotal)+' '+currency),tr(`DPH ${vatPct}%`,money(vatAmt)+' '+currency),tr('Celkem vč. DPH',money(total)+' '+currency)].join('')});</script></body></html>